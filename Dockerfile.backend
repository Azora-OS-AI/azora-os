FROM node:18-alpine

WORKDIR /app

# Copy package.json files for all services
COPY services/*/package.json ./

# Install common dependencies
RUN apk add --no-cache python3 make g++

# Set npm configuration for production build
ENV NODE_ENV=production
ENV NPM_CONFIG_LOGLEVEL=error

# Entry point to execute dynamically
ENTRYPOINT ["node"]
